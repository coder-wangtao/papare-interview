1.实时协作开发会遇到的问题：
实时通信
编辑冲突以及文档的一致性
离线编辑和数据同步

<1.1> 实时通信：WebSocket 提供一个持久的双向通信通道
<1.2> 编辑冲突与一致性：这个涉及到一些算法(OT、CRDT)
<1.3> 离线编辑和数据同步：使用 IndexedDB 来本地存储编辑操作的日志，联网之后就需要同步离线时所编辑的内容。

整体架构如下：
<1>客户端与前端服务器的交互
建立连接：客户 A 和客户 B 都与前端服务器**建立 WebSocket 连接**。
发送操作：当客户 A 进行编辑操作时，操作通过 WebSocket 连接发送到前端服务器。同样，客户 B 的操作也通过其 WebSocket 连接发送到前端服务器。
<2>前端服务器的职责
接收操作：前端服务器接收到来自客户 A 和客户 B 的编辑操作。
初步处理：前端服务器可以**对这些操作进行初步处理**，比如进行简单的**验证、过滤，或是进行某些预处理**（如记录日志、缓存等）。
转发操作：前端服务器将处理后的编辑操作转发给后端服务器。
<3>后端服务器的职责
接收操作：后端服务器接收到来自前端服务器的编辑操作。
冲突解决：**后端服务器使用 OT 或 CRDT 算法来处理冲突**，并合并操作，确保文档的一致性。
数据持久化：将合并后的编辑操作实时存储到数据库中，并更新文档的最新状态。
同步更新：后端服务器将最新的文档状态发送回前端服务器。
<4>前端服务器的回传：前端服务器接收到后端服务器传回的最新文档状态后，通过 **WebSocket 将最新状态广播给所有连接的客户端**

<2>整个架构因为涉及到了 BFF 层，所以安全验证的工作也是咱们前端来做的。

<3>编辑冲突和一致性(看一下代码)
OT：核心思想是将操作进行转换
CRDT：设定一种特定的数据类型来解决

<4>离线编辑和数据同步
使用 IndexedDB 来本地存储编辑操作的日志，联网之后就需要同步离线时所编辑的内容。
